<!DOCTYPE html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title> Techment Technology Assignment </title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
</head>

<body class="bg-dark">
    
<!----------------------------Start of create Data Modal ----------------------------------->

<div class="modal fade" id="employeeaddmodal" title="Create new Employee" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <!--<div class="modal-content">-->
       <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">ADD EMPLOYEE DATA</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        
        <form>
          <div class="modal-body">
                  <div class="form-group">
                      <label>Employee Name</label>
                      <input type="text" maxlength="40" name="empname" id="createempname" class="form-control inputTextBox" placeholder="Enter Employee Name" required />
                  </div>
                  <div class="form-group">
                      <label>Employee Salary</label>
                      <input type="number" min="0" name="empsalary" id="createempsalary" class="form-control" placeholder="Enter Employee Salary" required/> 
                  </div>
                  <div class="form-group">
                      <label>Employee Age</label>
                      <input type="number" min="0" name="empage" id="createempage" class="form-control" placeholder="Enter Employee Age" required />
                  </div>
          </div>
          
          <div class="modal-footer">
              <button type="reset" class="btn btn-warning" data-dismiss="modal">Close</button>
              <button type="button" onclick="createNewEmployee();" value="Submit" name="createdata" class="btn btn-primary" >Save Data</button>
          </div>
        </form>
  
      </div>
    </div>
  </div>
  
  <!---------------------------------End of create Data Modal----------------------------------->


  
<!----------------------------Start of Update Data Modal ----------------------------------->
<div class="modal fade" id="employeeupdatemodal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" >
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">UPDATE EMPLOYEE DATA</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        
        <form >
          <div class="modal-body">
                  
                  <div class="form-group">
                      <label>Employee Name</label>
                        <input type="text" maxlength="40" name="employee_name" id="updateempname" class="form-control inputTextBox" placeholder=" Employee Name unavailable" required />
                </div>
                  <div class="form-group">
                      <label>Employee Salary</label>
                      <input type="number" min="0" name="employee_salary" id="updateempsalary" class="form-control" placeholder=" Employee Salary unavailable" required />
                  </div>
                  <div class="form-group">
                      <label>Employee Age</label>
                      <input type="number" min="0" name="employee_age" id="updateempage" class="form-control" placeholder=" Employee Age unavailable" required />
                  </div>
                  <div class="form-group">
                    <label>Employee ID</label>
                    <input type="number" name="employee_id" id="updateempid" class="form-control" placeholder="Employee id unavailable" disabled>
                </div>
          </div>
          
          <div class="modal-footer">
              <button type="button" class="btn btn-warning" data-dismiss="modal">Close</button>
              <button type="button" onclick="saveupdatedinfo();" value="Submit" name="updatedata" class="btn btn-primary">Save Data</button>
          </div>
        </form>
  
      </div>
    </div>
  </div>
  
  <!---------------------------------End of Update Data Modal----------------------------------->


  <!----------------------------Start of delete Data Modal ----------------------------------->
<div class="modal fade" id="employeedeletemodal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">ARE SURE ABOUT DELETING EMPLOYEE DATA?</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        
        <form>          
          <div class="modal-footer">
              <button type="button" class="btn btn-warning" data-dismiss="modal">NO</button>
              <button type="button" onclick="deletedetails();" value="Submit" name="deletedata" class="btn btn-primary">YES</button>
          </div>
        </form>
  
      </div>
    </div>
  </div>
  
  <!---------------------------------End of delete Data Modal----------------------------------->

        
    <div class="container">
        <div class="jumbotron">
            <div class="card bg-info text-center">
                <h2> EMPLOYEE DETAILS </h2>
            </div>

            <div class="card">
                <div class="card-body">                
                    <button type="button" class="btn btn-success" data-toggle="modal" data-target="#employeeaddmodal">
                        ADD NEW EMPLOYEE
                    </button>
                </div>
            </div>

            <table id="employeetable" class="table table-striped table-bordered">  
                <thead>  
                    <tr>  
                        <th scope="col">ID</th>
                        <th scope="col">EMPLOYEE NAME</th>
                        <th scope="col">EMPLOYEE SALARY</th>
                        <th scope="col">EMPLOYEE AGE</th>
                        <th scope="col">UPDATE DATA</th>
                        <th scope="col">DELETE DATA</th> 
                    </tr>  
                </thead>  
                <tbody>

                </tbody>  
            </table>  
        </div>
    </div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

<script>
        
$(document).ready(function() {  
    getEmployees();  
});  

//fetching of data
function getEmployees() {  

    
    $.ajax({  
        type: "Get", 
        url: "http://dummy.restapiexample.com/api/v1/employees",
        dataType: "json",  
       
        success: function(data) {
               
            // console.log(data); 
            var i = 1; 
            $.each(data, function(index, value) {  
  
                var html = "<tr><td>" + value.id + "</td><td>" + value.employee_name + "</td><td>" + value.employee_salary + "</td><td>" + value.employee_age + "</td><td><a href='#' data-target='#employeeupdatemodal' data-toggle='modal' onclick='updatedetails(" + value.id + ")'><img src='image/edit.png'></a></td><td><a href='#' data-target='#employeedeletemodal' data-toggle='modal' onclick='deleteEmployee(" + value.id + ");'><img src='image/delete.png'></a></td></tr>";  
                $('.table tbody').append(html);  
  
            });  

        },  
        error: function(error) {  
            console.log(JSON.stringify(error));  
  
        }  
    })  
}  

//creating of data
function createNewEmployee() {  
  

    var createInfo = {
        name : $('#createempname').val(),  
        salary : $('#createempsalary').val(),  
        age: $('#createempage').val(),
    }  
    
    //validation at time of craeting data
    if($('#createempname').val() ==  '')
    {
          alert("Please enter Employee name.");
          $('#createempname').css('border-color', 'red'); 
          return false;
    }
    else if($('#createempsalary').val() == '')
    {
          alert("Please enter Employee salary.");
          $('#createempsalary').css('border-color', 'red');
          return false;
    }
    else if($('#createempage').val() == '')
    {
          alert("Please enter Employee age.");
          $('#createempage').css('border-color', 'red');
          return false;
    }
    else if($('#createempsalary').val().length > 8)
    {
          alert("Please check! max length of salary is 8 digits");
          $('#createempsalary').css('border-color', 'red'); 
          return false;
    }
    else if ($('#createempage').val() < 18 || $('#createempage').val().length > 3) 
    {
          alert("Please check! Age must be greater than 18 years and max-length of age is 3 digits.");
          $('#createempage').css('border-color', 'red'); 
          return false;
    }

    
   
    else{

    $('#createempname').css('border-color', 'green');
    $('#createempsalary').css('border-color', 'green');       
    $('#createempage').css('border-color', 'green'); 
    $.ajax({  

        type: "POST",  
        url: "http://dummy.restapiexample.com/api/v1/create",  
        contentType: "application/json",
        
       
        success: function(data) {    
            console.log(data);   
            alert("Employee Record added successfully", "success");  
            location.reload(true);
        },  
        error: function(error) {  
            console.log(JSON.stringify(error)); 
             
        }  ,
        data : JSON.stringify(createInfo)
  
    }) ;   
  }  
}


// for populating the Modal for updation
function updatedetails(id){
    
    $.ajax({  
      url:"http://dummy.restapiexample.com/api/v1/employee/"+id+"",  
      type: "GET",  
      contentType:'application/json',

        success: function(data) {  
          console.log(data); 
          var data1 = data ;
           var response = JSON.parse(data1);
            $("#updateempname").val(response.employee_name);
            $("#updateempsalary").val(response.employee_salary);
            $("#updateempage").val(response.employee_age);
            $("#updateempid").val(response.id);

      },  
      error: function(error) {  
          console.log(JSON.stringify(error));  

      } 
  })  
}


// Saving updated data
function saveupdatedinfo() {  
      var id = $('#updateempid').val();
       var updateInfo = {
        name : $('#updateempname').val(),  
        salary : $('#updateempsalary').val(),  
        age: $('#updateempage').val(),
        
    }  

    //validation at time of updating data
    if($('#updateempname').val() ==  '')
    {
          alert("Please enter Employee name.");
          $('#updateempname').css('border-color', 'red'); 
          return false;
    }
    else if($('#updateempsalary').val() == '')
    {
          alert("Please enter Employee salary.");
          $('#updateempsalary').css('border-color', 'red');
          return false;
    }
    else if($('#updateempage').val() == '')
    {
          alert("Please enter Employee age.");
          $('#updateempage').css('border-color', 'red');
          return false;
    }
    else if($('#updateempsalary').val().length > 8)
    {
          alert("Please check! max length of salary is 8 digits");
          $('#updateempsalary').css('border-color', 'red'); 
          return false;
    }
    else if ($('#updateempage').val() < 18 || $('#updateempage').val().length > 3) 
    {
          alert("Please check! Age must be greater than 18 years and max-length of age is 3 digits.");
          $('#updateempage').css('border-color', 'red'); 
          return false;
    }

    
   
    else{

    $('#updateempname').css('border-color', 'green');
    $('#updateempsalary').css('border-color', 'green');       
    $('#updateempage').css('border-color', 'green'); 

    $.ajax({  
        url: "http://dummy.restapiexample.com/api/v1/update/"+id+"",  
        type: "PUT",    
        contentType:'application/json',
        success: function(data) {  
            alert("Employee Record Updated successfully", "success");  
            location.reload(true);
        },  
        error: function(error) {  
            console.log(JSON.stringify(error));  
  
        },
        data : JSON.stringify(updateInfo)
  
    })  
}
}
  
  

// deleting data
var Did;//For saving ID (to be deleted)
function deleteEmployee(IDvalue) {  
  
    
         console.log(IDvalue);
         Did = IDvalue;
}
    
function deletedetails(){
    $.ajax({  

      url: "http://dummy.restapiexample.com/api/v1/delete/"+Did+"",  
      type: "DELETE",
      success: function(data) {  

          alert("Employee Record deleted succesfully", "success");  
          location.reload(true);
      },  
      error: function(error) {  
          console.log(JSON.stringify(error));  
      }  
       })  
} 
</script>

<script>
  //validation for name text box in form
  $(document).ready(function(){
    $(".inputTextBox").keypress(function(event){
        var inputValue = event.charCode;
        if(!(inputValue >= 65 && inputValue <= 121) && (inputValue != 32 && inputValue != 0)){
            event.preventDefault();
        }
    });
});
</script>

</body>
</html>
        